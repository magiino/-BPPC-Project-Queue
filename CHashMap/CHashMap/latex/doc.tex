\subsection*{Teoretický popis\+: Termín datový kontejner a datová struktura Hash\+Map}

Termín kontejner představuje v oblasti návrhu datových struktur a algoritmů takový datový typ, který umožňuje za běhu programu sdružovat více prvků (stejného nebo i různého typu) do jedné složené datové struktury. Výhody spojené s používáním kontejneru lze najít například v jednoduchém předání všech prvků takového kontejneru do funkce pomocí jediného parametru (typu kontejner), nebo pro předání více hodnot z funkce, kde návratovou hodnotou je opět jediná hodnota (typu kontejner). Hlavní výhodou je ovšem možnost provedení operace nad všemi prvky kontejneru pomocí zápisu jediného volání služby, kterou zajistí přímo daný kontejner v rámci svého A\+PI. Mezi takové služby může patřit dealokace paměti všech prvků v kontejneru, vytisknutí všech prvků v kontejneru a další operace spojené se správou prvků v kontejneru.

Datový kontejner bude ve Vašem projektu realizován pomocí datové sktruktury \href{https://en.wikipedia.org/wiki/Hash_table}{\tt Hash table} (neuspořádané pole prvků (tj. seznam prvků s klíčem/indexem a hodnotou). Tato datová struktura vychází svými základy z \href{https://en.wikipedia.org/wiki/Linked_list}{\tt lineárního jednosměrně vázaného seznamu}, ale rozšiřuje jej o možnost časově efektivního průchodu seznamem při hledání konkrétního prvku. Modifikací datové struktury hašovací tabulky je Hash\+Mapa resp. \href{https://en.wikipedia.org/wiki/Multimap}{\tt Hash\+Multi\+Mapa} umožňujicí vícenásobné vložení prvků se stejným klíčem případně i se stejným klíčem a hodnotou.

Hash\+Mapa se tedy skládá z pole jednosměrně vázaných seznamů (v projektu proměnná \hyperlink{class_c_hash_map_a1018fdaad71e8207e747db26e88025d6}{i\+Bucket\+Table}). Základním prvkem jednosměrně vázaného seznamu je struktura \hyperlink{struct_c_hash_map_1_1_t_item}{T\+Item}, která obsahuje ukazatel na další prvek v seznamu a datový člen. Datovým členem je třída \hyperlink{class_c_pair}{C\+Pair}, která obsahuje klíč a vlastní hodnotu. Vlastní hodnota je reprezentována prvkem třídy \hyperlink{class_c_value__bool_1_1_c_value}{C\+Value}.

Pro činnost Hash\+Map je důležitá Hash\+Function (tzv. hašovací funkce), ve třídě \hyperlink{class_c_hash_map}{C\+Hash\+Map} je to metoda \hyperlink{class_c_hash_map_ad7230ba064063608b7e49495d3660426}{Calculate\+Hash()}), která na základě hodnoty klíče určí index lineárního seznamu v poli \hyperlink{class_c_hash_map_a1018fdaad71e8207e747db26e88025d6}{i\+Bucket\+Table}, do kterého daný pár klíč/hodnota patří.

Počet prvků tabulky \hyperlink{class_c_hash_map_a8745c6aa08e235500828dea0ad30b548}{i\+Bucket\+Table\+Size} se vhodně zvolí na základě dané úlohy. Tomuto počtu musí odpovídat výsledky hašovací funkce, která by měla rozdělovat prvky do tabulky statisticky rovnoměrně a to pro celý předpokládaný rozsah hodnot klíčů.

Hašovací tabulka je reprezentovaná polem prvků typu \hyperlink{struct_c_hash_map_1_1_t_bucket}{T\+Bucket}, který pro manipulaci se seznamy obsahuje ukazatele na první \hyperlink{struct_c_hash_map_1_1_t_bucket_a03a10c5ce912fd09137778c3454e7d77}{i\+Head} a poslední \hyperlink{struct_c_hash_map_1_1_t_bucket_a1b8b634924907ed251a58eee989d577a}{i\+Tail} položku lineárního seznamu. Pokud pro danou položku (hash kód) nebyl vložen žádný prvek, odkazují oba ukazatele na hodnotu {\ttfamily nullptr}.

Využití principu hašování má tu výhodu, že pro hodnoty klíčů, které mohou nabývat širokého rozsahu a mít nerovnoměrný výskyt, provede hašovací funkce přepočet klíče na index ({\ttfamily idx}) o daleko menším rozsáhu (vznikne tzv. otisk či miniatura hodnoty původního klíče).

Vytvoření hašovací tabulky (tj. tabulky miniatur) obsahující počátky jednotlivých lineárně vázaných seznamů je dosaženo \char`\"{}relativně\char`\"{} paměťově úsporného kontejneru, ale také výpočetně efektivního přístupu k nalezení položky s daným klíčem (ve srovnání s jediným lineárním seznamem všech prvků).


\begin{DoxyImage}
\includegraphics[width=\textwidth,height=\textheight/2,keepaspectratio=true]{dot_CPair}
\doxyfigcaption{Obr. 1 -\/ Instance třídy {\ttfamily C\+Pair} představující pár s datovými složkami klíč a hodnota}
\end{DoxyImage}
~\newline
 
\begin{DoxyImage}
\includegraphics[width=\textwidth,height=\textheight/2,keepaspectratio=true]{dot_CHashMapPrimitive}
\doxyfigcaption{Obr. 2 -\/ Příklad elementárního seznamu uloženého ve struktuře {\ttfamily T\+Bucket} se třemi prvky {\ttfamily T\+Item} }
\end{DoxyImage}
~\newline
 
\begin{DoxyImage}
\includegraphics[width=\textwidth,height=\textheight/2,keepaspectratio=true]{dot_CHashMap}
\doxyfigcaption{Obr. 3 -\/ Princip uložení šesti prvků {\ttfamily C\+Pair} \{0,\textquotesingle{}A\textquotesingle{}\}, \{1,\textquotesingle{}B\textquotesingle{}\}, \{1,\textquotesingle{}C\textquotesingle{}\}, \{3,\textquotesingle{}D\textquotesingle{}\}, \{5,\textquotesingle{}E\textquotesingle{}\}, \{11,\textquotesingle{}F\textquotesingle{}\} v multimapě {\ttfamily C\+Hashmap} }
\end{DoxyImage}
~\newline


~\newline


\subsection*{Popis implementace}

V tomto školním C++ projektu je Hash\+Mapa realizována za pomocí pole lineárních seznamů. Pro svou činnost definuje a využívá další pomocné datové typy. Pro pole lineárních seznamů používá datový typ \hyperlink{struct_c_hash_map_1_1_t_bucket}{T\+Bucket}, který obsahuje ukazatele na první a poslední prvek lineárního seznamu. Lineární seznam je tvořen za pomoci prvků datového typu \hyperlink{struct_c_hash_map_1_1_t_item}{T\+Item}, který obsahuje datový prvek a ukazatel na další položku v lineárním seznamu. Datový prvek je realizován pomocí typu \hyperlink{class_c_pair}{C\+Pair}, který obsahuje dvojici klíč a vlastní hodnotu. Hodnota je realizována jedním z připravených typů \hyperlink{class_c_value__bool_1_1_c_value}{C\+Value}.

Pro práci s prvky Hash\+Map seznamu je vytvořen iterátor (\hyperlink{class_c_hash_map_1_1_c_forward_iterator}{C\+Forward\+Iterator}), který realizuje dopředné procházení seznamu. Dále jsou pro práci s prvky Hash\+Map předdefinovány konstanty, které umožňují řešit různý přístup k duplicitním prvkům při hledání (\hyperlink{class_c_hash_map_a9c8b9ae56d510ae0ff5e9ba74ee9930d}{C\+Hash\+Map\+::\+T\+At}), a nebo určit implicitní způsob řazení prvků (\hyperlink{class_c_hash_map_ad4dd353df970a4464c449ef9f3b6a172}{C\+Hash\+Map\+::\+T\+Insert}).

{\bfseries Celý projekt kontejneru budete realizovat bez podpory standardních kontejnerových typů knihovny S\+TL nebo jiných knihoven třetích stran!}

\subsubsection*{Třída \hyperlink{class_c_hash_map}{C\+Hash\+Map}}

Třída \hyperlink{class_c_hash_map}{C\+Hash\+Map} je základní třídou, která realizuje mechanizmus uchování prvků a určuje způsob jakým se s nimi pracuje. Princip uložení prvků je mechanizmus Hash\+Map, kdy na základě klíče datové položky je určena pozice dvojice klíč/hodnota v Hash\+Map. Za pomoci hašovací funkce \hyperlink{class_c_hash_map_ad7230ba064063608b7e49495d3660426}{C\+Hash\+Map\+::\+Calculate\+Hash} je pomocí klíče v tabulce určen lineární seznam, do kterého daná položka (vkládaná, vybíraná, hledaná ...) patří. Základním prvkem třídy \hyperlink{class_c_hash_map}{C\+Hash\+Map} je pole struktur \hyperlink{struct_c_hash_map_1_1_t_bucket}{T\+Bucket}, které odkazuje na jednotlivé lineární seznamy obsahující datové prvky. Tato třída realizuje kompletní funkčnost pro manipulaci s prvky (včetně práce s prvky lineárního seznamu).

Pro určení způsobu řazení prvků, které v seznamu existují vícenásobně (tj. ošetření dvojic se stejnými hodnotami klíč nebo i hodnota) jsou vytvořeny konstanty pomocí výčtového typu \hyperlink{class_c_hash_map_ad4dd353df970a4464c449ef9f3b6a172}{T\+Insert}. Promyslete si využití těchto hodnot pro realizaci Vašeho kontejneru. Je možné určit, že se duplicita nezařadí, nebo že se zařadí před či za prvky se stejnými hodnotami.

\subsubsection*{Třída \hyperlink{class_c_hash_map_1_1_c_forward_iterator}{C\+Hash\+Map\+::\+C\+Forward\+Iterator}}

Pro manipulaci s prvky kontejnerů jsou často používány iterátory. Iterátor slouží k postupnému procházení kontejneru po jednotlivých prvcích. V projektu je vytvořen iterátor, který se váže na daný objekt \hyperlink{class_c_hash_map}{C\+Hash\+Map} a umožňuje nastavení své pozice na začátek nebo za konec prvků mapy. Umožňuje též procházení prvků po jednom dopředu -\/ prochází se prvky \hyperlink{class_c_hash_map}{C\+Hash\+Map} a to tak, že se postupně prochází jednotlivé lineární seznamy pole \hyperlink{class_c_hash_map_a1018fdaad71e8207e747db26e88025d6}{i\+Bucket\+Table} mapy. Při nalezení posledního prvku v daném lineárního seznamu se začne procházet další položka (další lineární seznam) z pole \hyperlink{class_c_hash_map_a1018fdaad71e8207e747db26e88025d6}{i\+Bucket\+Table}. Aktuální prvek, na který iterátor ukazuje je možné získat a pracovat s ním pomocí předdefinovaného \hyperlink{class_c_hash_map_1_1_c_forward_iterator_a7f44403bd74fc55f0263b56cf15fc64b}{operátoru $\ast$} a \hyperlink{class_c_hash_map_1_1_c_forward_iterator_a65fde4bd503e69c29b15688cd8c21eaf}{operatoru -\/$>$}. Instance iterátoru vždy ověřuje, zda pomocí indexace přistupujeme k existujícímu prvku mapy a v případě neplatného indexu generuje výjimku {\ttfamily std\+::out\+\_\+of\+\_\+range}. Dále je třeba vzít v úvahu skutečnost, že iterátor je asociován se zvolenou mapou pouze jednosměrně, tj. pokud z mapy odebereme prvek, iterátor nemá možnost se aktualizovat. Mapa neobsahuje seznam iterátorů, které vytvořila a nemůže tedy provést automatickou aktualizaci (změnu hodnoty) všech vytvořených iterátorů.

\subsubsection*{Struktura \hyperlink{struct_c_hash_map_1_1_t_item}{C\+Hash\+Map\+::\+T\+Item}}

Pomocná struktura, která slouží jako prvek lineárního seznamu. Obsahuje datový prvek třídy \hyperlink{class_c_pair}{C\+Pair} se jménem \hyperlink{struct_c_hash_map_1_1_t_item_a9b832f579f07c1011ef58d89a589470a}{i\+Pair} a ukazatel na další prvek seznamu \hyperlink{struct_c_hash_map_1_1_t_item_a7d4fed6cab5e5e567fddc934a8ace1f7}{i\+Next}. Je-\/li posledním prvkem, obsahuje ukazatel hodnotu {\ttfamily nullptr}. Vytvořený lineární seznam je v Hash\+Map uchováván pomocí odkazu v poli pomocných struktur \hyperlink{struct_c_hash_map_1_1_t_bucket}{T\+Bucket}.

\subsubsection*{Struktura \hyperlink{struct_c_hash_map_1_1_t_bucket}{C\+Hash\+Map\+::\+T\+Bucket}}

Pomocná struktura, která ve třídě \hyperlink{class_c_hash_map}{C\+Hash\+Map} slouží k uchování odkazů na jednotlivé lineární seznamy. Každý prvek třídy \hyperlink{struct_c_hash_map_1_1_t_bucket}{T\+Bucket} uchovává odkaz na první \hyperlink{struct_c_hash_map_1_1_t_bucket_a03a10c5ce912fd09137778c3454e7d77}{i\+Head} a poslední \hyperlink{struct_c_hash_map_1_1_t_bucket_a1b8b634924907ed251a58eee989d577a}{i\+Tail} prvek téhož seznamu. Neobsahuje-\/li žádný člen, jsou obě složky třídy nastaveny na {\ttfamily nullptr}.

\subsubsection*{Třída \hyperlink{class_c_pair}{C\+Pair}}

Představuje kontejnerovou datovou strukturu, kterou využívá struktura \hyperlink{struct_c_hash_map_1_1_t_item}{T\+Item} pro uchování dat. Vlastní data se skládají z dvojice klíče \hyperlink{class_c_pair_a37d0dd4585094709d0536f47453a2a38}{i\+Key} a hodnoty \hyperlink{class_c_pair_a469ab54768d718dd0072d8878fd44611}{i\+Value}.

\subsubsection*{Třída C\+Value}

Třída \hyperlink{class_c_value__bool_1_1_c_value}{C\+Value} obsahuje prvek (nebo prvky) mající hodnotu vkládanou do kontejneru. Úlohou třídy \hyperlink{class_c_value__bool_1_1_c_value}{C\+Value} je zapouzdřit vlastní hodnotu -\/ datovou složku \hyperlink{class_c_value__bool_1_1_c_value_a2a05b9efee1e0497a631a39b0146b776}{i\+Value}, která představuje užitečná/pracovní data, která bude každý prvek seznamu obsahovat. Pro tuto třídu je třeba vhodně upravit (případně doplnit) metody určené pro konstrukci a likvidaci prvku tak, aby bylo možné nový prvek efektivně konstruovat a využívat. Třída \hyperlink{class_c_value__bool_1_1_c_value}{C\+Value} je navíc správcem své vlastní hodnoty \hyperlink{class_c_value__bool_1_1_c_value_a2a05b9efee1e0497a631a39b0146b776}{i\+Value} a proto definuje základní metody pro zjištění, nastavení této hodnoty a zároveň zajišťuje pro nadřazené vyšší části programu metody pro porovnání dvou prvků \hyperlink{class_c_value__bool_1_1_c_value}{C\+Value} dle této hodnoty, čímž izoluje nadřazené části od nutnosti znát konkrétní datový typ složky \hyperlink{class_c_value__bool_1_1_c_value_a2a05b9efee1e0497a631a39b0146b776}{i\+Value}. Využití této třídy v rámci \hyperlink{class_c_hash_map}{C\+Hash\+Map} i výsledného kontejneru musí být ovšem takové, aby \hyperlink{class_c_hash_map}{C\+Hash\+Map} i výsledný kontejner pracovali s jakoukoli třídou \hyperlink{class_c_value__bool_1_1_c_value}{C\+Value} jednotně, bez úprav kódu mapy nebo kontejneru.

\subsubsection*{Třída Class\+Info}

Třída Class\+Info implementuje mechanismus automatického počítání vzniklých objektů a mechanismus jednoznačné identifikace Class\+Info$<$$>$\+::\+ID \char`\"{}\+I\+D\char`\"{} instancí za běhu programu. Tento mechanismus se Vám bude hodit při ladění programu. Všechny Vaše třídy by měly obsahovat datovou složku {\ttfamily i\+Instance\+Info} třídy Class\+Info, čímž zajistíte Vašim třídám tyto ladicí vlastnosti. Samotná třída Class\+Info je definována jako šablona umožňující, vznik různých variant této třídy -\/ (generické programování resp. metaprogramování).

Mezi ladicí metody třídy Class\+Info patří\+: \begin{DoxyItemize}
\item Class\+Info$<$\+T$>$\+::\+Total() -\/ počítadlo vzniklých instancí třídy T \item Class\+Info$<$\+T$>$\+::\+Living() -\/ počítadlo v daném okamžiku existujících instancí třídy T \item Class\+Info$<$\+T$>$\+::\+I\+D() resp. \hyperlink{class_c_value__bool_1_1_c_value_a028335ed71781b92b96dfb51e1118eda}{C\+Value\+:\+:ID()} -\/ unikátní číselné označení dané instance\end{DoxyItemize}
\begin{DoxyAttention}{Attention}
Projděte si všechny uvedené kontrolní i ladicí mechanismy, snažte se pochopit jejich smysl a využití při trasování programu. Získané vědomosti se Vám budou rozhodně hodit, například když se nějaká část Vašeho programu začne chovat \char`\"{}nepřátelsky\char`\"{}.
\end{DoxyAttention}
\begin{DoxyNote}{Note}
Hodně štěstí při realizaci Vašeho projektu. Nebojte se, ono to půjde. Hlavně {\itshape nepropadejte panice!} ;-\/)
\end{DoxyNote}
Richter \& Petyovský.

\begin{DoxyParagraph}{Id}
\hyperlink{_documentation_8md}{Documentation.\+md} 2 2017-\/11-\/06 10\+:01\+:25Z petyovsky 
\end{DoxyParagraph}
